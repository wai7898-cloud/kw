<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é›™äºº 52 é€±å­˜éŒ¢ç´€éŒ„ | æ°¸ä¹…ä¿å­˜ç‰ˆ</title>
    <style>
        :root {
            --rose-quartz: #F7CAC9;
            --serenity: #92A8D1;
            --bg: #fdfcfb;
        }

        body {
            font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
            background: linear-gradient(135deg, #fdfcfb 0%, #e2eafc 100%);
            background-attachment: fixed;
            margin: 0;
            padding: 20px;
            color: #555;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .status-msg {
            position: fixed;
            top: 20px;
            background: rgba(0,0,0,0.6);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.8rem;
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
            z-index: 100;
        }

        .header { text-align: center; margin-bottom: 25px; }
        .header h1 { color: #7a8eb5; margin-bottom: 5px; letter-spacing: 2px; }

        .container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(360px, 1fr));
            gap: 20px;
            width: 100%;
            max-width: 1100px;
        }

        .card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.05);
            border-top: 10px solid;
        }

        .p1-card { border-color: var(--rose-quartz); }
        .p2-card { border-color: var(--serenity); }

        .name-edit {
            font-size: 1.4rem;
            font-weight: bold;
            border: none;
            background: transparent;
            color: #444;
            width: 100%;
            margin-bottom: 15px;
            outline: none;
        }

        .stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            background: #fff;
            padding: 12px;
            border-radius: 12px;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.02);
        }

        .stat-box { text-align: center; flex: 1; }
        .stat-box small { color: #999; font-size: 0.75rem; }
        .stat-box div { font-weight: bold; font-size: 1.1rem; }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(65px, 1fr));
            gap: 8px;
        }

        .box {
            aspect-ratio: 1.2;
            background: white;
            border: 1px solid #eee;
            border-radius: 10px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .box:hover { transform: translateY(-3px); box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .box b { font-size: 0.9rem; }

        .p1-done { background: var(--rose-quartz) !important; color: white; border-color: var(--rose-quartz); }
        .p2-done { background: var(--serenity) !important; color: white; border-color: var(--serenity); }

        .reset-btn {
            margin-top: 40px;
            color: #ccc;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 0.8rem;
            text-decoration: underline;
        }
    </style>
</head>
<body>

<div id="status" class="status-msg">å·²è‡ªå‹•å„²å­˜é€²åº¦</div>

<div class="header">
    <h1>52-WEEK CHALLENGE</h1>
    <p>ğŸ’¡ æ•¸æ“šä¿å­˜åœ¨æ­¤ç€è¦½å™¨ï¼Œé‡æ–°é–‹å•Ÿå³å¯çœ‹åˆ°ç´€éŒ„</p>
</div>

<div class="container">
    <div class="card p1-card">
        <input type="text" id="p1Name" class="name-edit" value="Kçš„è¨ˆç•«" onchange="manualSave()">
        <div class="stats">
            <div class="stat-box"><small>ç¸½é‡‘é¡</small><div id="p1Total" style="color:#e59a98">$0</div></div>
            <div class="stat-box"><small>å®Œæˆåº¦</small><div id="p1Percent" style="color:#e59a98">0%</div></div>
        </div>
        <div id="p1Grid" class="grid"></div>
    </div>

    <div class="card p2-card">
        <input type="text" id="p2Name" class="name-edit" value="Wçš„è¨ˆç•«" onchange="manualSave()">
        <div class="stats">
            <div class="stat-box"><small>ç¸½é‡‘é¡</small><div id="p2Total" style="color:#7a8eb5">$0</div></div>
            <div class="stat-box"><small>å®Œæˆåº¦</small><div id="p2Percent" style="color:#7a8eb5">0%</div></div>
        </div>
        <div id="p2Grid" class="grid"></div>
    </div>
</div>

<button class="reset-btn" onclick="clearMemory()">æ¸…é™¤æœ¬åœ°æ‰€æœ‰ç´€éŒ„ä¸¦é‡ç½®</button>

<script>
    const weekAmounts = Array.from({length: 52}, (_, i) => (i + 1) * 10);
    
    // åˆå§‹åŒ–è³‡æ–™ç‰©ä»¶
    let savingsData = {
        p1: { name: 'Kçš„è¨ˆç•«', completed: [] },
        p2: { name: 'Wçš„è¨ˆç•«', completed: [] }
    };

    // å¾æœ¬åœ°è¨˜æ†¶ (localStorage) è®€å–è³‡æ–™
    function loadFromMemory() {
        const memory = localStorage.getItem('savings_app_v3');
        if (memory) {
            savingsData = JSON.parse(memory);
            document.getElementById('p1Name').value = savingsData.p1.name;
            document.getElementById('p2Name').value = savingsData.p2.name;
        }
        renderGrids();
    }

    // å„²å­˜åˆ°æœ¬åœ°è¨˜æ†¶
    function saveToMemory() {
        localStorage.setItem('savings_app_v3', JSON.stringify(savingsData));
        showStatus();
    }

    function showStatus() {
        const msg = document.getElementById('status');
        msg.style.opacity = '1';
        setTimeout(() => { msg.style.opacity = '0'; }, 1000);
    }

    function renderGrids() {
        ['p1', 'p2'].forEach(p => {
            const grid = document.getElementById(p + 'Grid');
            grid.innerHTML = '';
            
            weekAmounts.forEach((amt, i) => {
                const box = document.createElement('div');
                box.className = 'box';
                if (savingsData[p].completed.includes(i)) {
                    box.classList.add(p + '-done');
                }
                box.innerHTML = `<span>W${i+1}</span><b>$${amt}</b>`;
                box.onclick = () => toggleWeek(p, i);
                grid.appendChild(box);
            });
            updateStats(p);
        });
    }

    function toggleWeek(player, index) {
        const pos = savingsData[player].completed.indexOf(index);
        if (pos > -1) {
            savingsData[player].completed.splice(pos, 1);
        } else {
            savingsData[player].completed.push(index);
        }
        saveToMemory();
        renderGrids();
    }

    function manualSave() {
        savingsData.p1.name = document.getElementById('p1Name').value;
        savingsData.p2.name = document.getElementById('p2Name').value;
        saveToMemory();
    }

    function updateStats(p) {
        const total = savingsData[p].completed.reduce((sum, idx) => sum + weekAmounts[idx], 0);
        const percent = ((savingsData[p].completed.length / 52) * 100).toFixed(1);
        document.getElementById(p + 'Total').innerText = `$${total.toLocaleString()}`;
        document.getElementById(p + 'Percent').innerText = `${percent}%`;
    }

    function clearMemory() {
        if(confirm('è­¦å‘Šï¼šé€™å°‡æ°¸ä¹…åˆªé™¤æ‚¨èˆ‡æœ‹å‹çš„æ‰€æœ‰å­˜éŒ¢é€²åº¦ï¼ç¢ºå®šå—ï¼Ÿ')) {
            localStorage.removeItem('savings_app_v3');
            location.reload();
        }
    }

    // å•Ÿå‹•ç¨‹å¼
    loadFromMemory();
</script>

</body>
</html>




<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>52é€±å­˜éŒ¢åŒæ­¥ç‰ˆ</title>
    <style>
        :root { --rose-quartz: #F7CAC9; --serenity: #92A8D1; }
        body { font-family: sans-serif; background: #fdfcfb; color: #555; text-align: center; padding: 20px; }
        .container { display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; max-width: 1000px; margin: 0 auto; }
        .card { background: white; border-radius: 20px; padding: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); flex: 1; min-width: 320px; border-top: 8px solid; }
        .p1-card { border-color: var(--rose-quartz); } .p2-card { border-color: var(--serenity); }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(60px, 1fr)); gap: 8px; margin-top: 15px; }
        .box { aspect-ratio: 1.2; border: 1px solid #eee; border-radius: 8px; display: flex; flex-direction: column; justify-content: center; cursor: pointer; font-size: 0.7rem; transition: 0.2s; }
        .p1-done { background: var(--rose-quartz) !important; color: white; }
        .p2-done { background: var(--serenity) !important; color: white; }
        #sync-status { position: fixed; top: 10px; right: 10px; background: #333; color: #fff; padding: 5px 12px; border-radius: 20px; font-size: 12px; display: none; }
    </style>
</head>
<body>

<div id="sync-status">åŒæ­¥ä¸­...</div>
<h1>52-WEEK CHALLENGE</h1>
<p>â˜ï¸ é›²ç«¯åŒæ­¥æ¨¡å¼ï¼šä¸åŒè£ç½®é–‹å•Ÿä¹Ÿæœƒé¡¯ç¤ºç›¸åŒç´€éŒ„</p>

<div class="container">
    <div class="card p1-card">
        <h3>Kçš„è¨ˆç•«</h3>
        <div id="p1Total">é‡‘é¡: $0</div>
        <div id="p1Grid" class="grid"></div>
    </div>
    <div class="card p2-card">
        <h3>Wå‹çš„è¨ˆç•«</h3>
        <div id="p2Total">é‡‘é¡: $0</div>
        <div id="p2Grid" class="grid"></div>
    </div>
</div>

<script>
    // âš ï¸ é€™è£¡è«‹æ›æˆæ‚¨éƒ¨ç½²å¾Œçš„ Google API ç¶²å€
    const API_URL = "https://script.google.com/macros/s/AKfycbzFICP3M0SNCFLG28cbvs8ayoSk7Mhbj-kQC1uHzh18IKAdKrnvOtTMazxWbdCxp3g0pQ/exec"; 

    const weekAmounts = Array.from({length: 52}, (_, i) => (i + 1) * 10);
    let state = { p1: [], p2: [] };

    async function fetchData() {
        showLoading(true);
        try {
            const res = await fetch(API_URL);
            const data = await res.json();
            state.p1 = []; state.p2 = [];
            data.forEach((row, idx) => {
                if (row[0] === 1) state.p1.push(idx);
                if (row[1] === 1) state.p2.push(idx);
            });
            render();
        } catch (e) { console.error("åŒæ­¥å¤±æ•—", e); }
        showLoading(false);
    }

    async function toggle(player, idx) {
        showLoading(true);
        const isDone = !state[player].includes(idx);
        
        // å…ˆæ›´æ–°ç•«é¢è®“æ“ä½œæµæš¢
        if (isDone) state[player].push(idx);
        else state[player] = state[player].filter(i => i !== idx);
        render();

        // å‚³é€è‡³ Google é›²ç«¯
        try {
            await fetch(API_URL, {
                method: 'POST',
                body: JSON.stringify({ player: player, weekIdx: idx, status: isDone })
            });
        } catch (e) { alert("å„²å­˜å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯"); }
        showLoading(false);
    }

    function render() {
        ['p1', 'p2'].forEach(p => {
            const grid = document.getElementById(p + 'Grid');
            grid.innerHTML = '';
            let total = 0;
            weekAmounts.forEach((amt, i) => {
                const box = document.createElement('div');
                box.className = `box ${state[p].includes(i) ? p + '-done' : ''}`;
                box.innerHTML = `W${i+1}<br><b>$${amt}</b>`;
                box.onclick = () => toggle(p, i);
                grid.appendChild(box);
                if (state[p].includes(i)) total += amt;
            });
            document.getElementById(p + 'Total').innerText = `å·²å­˜é‡‘é¡: $${total}`;
        });
    }

    function showLoading(show) { document.getElementById('sync-status').style.display = show ? 'block' : 'none'; }

    fetchData(); // ç¶²é é–‹å•Ÿæ™‚è‡ªå‹•æŠ“å–é›²ç«¯è³‡æ–™
</script>
</body>
</html>

